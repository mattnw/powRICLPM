<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="powRICLPM">
<title>Power analysis • powRICLPM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power analysis">
<meta property="og:description" content="powRICLPM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">powRICLPM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Mulder2022.html">Results Mulder (2022)</a>
    <a class="dropdown-item" href="../articles/analysis.html">Power analysis</a>
    <a class="dropdown-item" href="../articles/mplus.html">Power analysis using Mplus</a>
    <a class="dropdown-item" href="../articles/speeding.html">Speeding up the analysis</a>
    <a class="dropdown-item" href="../articles/visualization.html">Visualize results</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JeroenDMulder/powRICLPM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Power analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JeroenDMulder/powRICLPM/blob/HEAD/vignettes/analysis.Rmd" class="external-link"><code>vignettes/analysis.Rmd</code></a></small>
      <div class="d-none name"><code>analysis.Rmd</code></div>
    </div>

    
    
<p>This vignette details how you can use the <code>powRICLPM</code> package to perform a power analysis for detecting a specific effect size in the random intercept cross-lagged panel model (RI-CLPM) with a desired power level. For example, we wish to detect a small cross-lagged effect <span class="math inline">\(\gamma_{2}\)</span> (defined here as the causal effect of <span class="math inline">\(x_{1}^{*}\)</span> to <span class="math inline">\(y_{2}^{*}\)</span>, where <span class="math inline">\(x_{1}^{*}\)</span> and <span class="math inline">\(y_{2}^{*}\)</span> denote the latent within-unit components of <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(y_{2}\)</span>, respectively) of 0.2 (standardized). Below, we will use the <code><a href="../reference/powRICLPM.html">powRICLPM()</a></code> function to compute the proportion of times we reject the null-hypothesis (i.e., the power), the width of the confidence interval (i.e., accuracy), and a host of other performance measures (e.g., bias, mean square error, standard deviation of the estimate, etc.) across different experimental conditions.</p>
<div class="section level2">
<h2 id="preparation">Preparation<a class="anchor" aria-label="anchor" href="#preparation"></a>
</h2>
<p>Before performing the power analysis, we must first determine the <em>experimental conditions</em> and <em>population parameter values</em>. Experimental conditions (or: simulation conditions) refer to characteristics of the study design that can impact statistical power. This includes characteristics like the <em>sample size</em> and the <em>number of repeated measures</em> included in the study. We must decide the number of repeated measures that will be used in the simulations, and the range of sample sizes over which to simulate the power. For our example, we will investigate the power for sample sizes from 100 to 1000 (with incremental steps of 50, resulting in 19 <em>conditions</em>) for an RI-CLPM with 3, 4 and 5 repeated measures.</p>
<p>Next, we must determine population parameter values for the RI-CLPM. These can be based on previous research, theory, or expert knowledge. The RI-CLPM requires the specification of:</p>
<ul>
<li>
<code>ICC</code>: The proportion of variance at the between-unit level (relative to the total variance).</li>
<li>
<code>RI_cor</code>: The correlation between the random intercepts.</li>
<li>
<code>Phi</code>: Standardized autoregressive and cross-lagged effects for the within-unit components of the model.</li>
<li>
<code>wSigma</code>: Correlations between the within-unit components.</li>
</ul>
<p>More information on how to decide on population parameter values can be found in LINK NAAR PAPER. For our example, the parameter values are set to:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ICC</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">RI_cor</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">Phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># The .2 refers to our standardized cross-lagged effect of interest</span>
<span class="va">wSigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.3</span>, <span class="fl">.3</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>To perform the power analysis, use the <code><a href="../reference/powRICLPM.html">powRICLPM()</a></code> function. We must provide:</p>
<ul>
<li>the desired power level using the <code>target_power</code> argument,</li>
<li>the range of sample sizes to simulate the power for using the <code>search_lower</code>, <code>search_upper</code>, and <code>search_step</code> arguments (alternatively, we can specify this directly by providing a vector of sample sizes to the <code>sample_size</code> argument),</li>
<li>the number of time points for the simulated data using the <code>time_points</code> argument,</li>
<li>the population values <code>ICC</code>, <code>RI_cor</code>, <code>Phi</code>, and <code>wSigma</code>, and</li>
<li>the number of Monte Carlo replications we want to perform per condition in the <code>reps</code> argument. Note that larger numbers of replications result in more reliable results, but are more computationally intensive, especially when simulating the power across a large range of sample sizes. More information on speeding up the analysis by performing the computations in parallel (i.e., using multiple cores on your computer) can be found at <a href="https://jeroendmulder.github.io/powRICLPM/parallel.html" class="external-link">https://jeroendmulder.github.io/powRICLPM/parallel.html</a>.</li>
</ul>
<p>For our example, we would specify:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This analysis will take a while...</span>
<span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/powRICLPM.html">powRICLPM</a></span><span class="op">(</span>target_power <span class="op">=</span> <span class="fl">0.8</span>,
                    search_lower <span class="op">=</span> <span class="fl">100</span>,
                    search_upper <span class="op">=</span> <span class="fl">1000</span>,
                    search_step <span class="op">=</span> <span class="fl">50</span>,
                    time_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,
                    ICC <span class="op">=</span> <span class="va">ICC</span>,
                    RI_cor <span class="op">=</span> <span class="va">RI_cor</span>, 
                    Phi <span class="op">=</span> <span class="va">Phi</span>,
                    wSigma <span class="op">=</span> <span class="va">wSigma</span>,
                    reps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p>Optionally, we can specify:</p>
<ul>
<li>
<code>skewness</code> and <code>kurtosis</code>: An integer (vector) that determines the skewness and kurtosis for the observed variables, respectively. Suppose we have reason to believe the <span class="math inline">\(Y\)</span> variables are positively skewed, and that the distribution of <span class="math inline">\(X\)</span> has heavy tails (i.e., a higher kurtosis). We can then include the arguments <code>skewness = c(0, 0, 0, 1, 1, 1)</code> and <code>kurtosis = c(0.5, 0.5, 0.5, 0, 0, 0)</code>, where the first three elements represent the observed <span class="math inline">\(X\)</span> variables, and the last three elements represent the observed <span class="math inline">\(Y\)</span> variables. By default, both arguments are set to 0.</li>
<li>
<code>alpha</code>: A numeric value denoting the significance criterion. It defaults to 0.05.</li>
<li>
<code>seed</code>: An integer to control the starting point of the random number generator. This is important to use if we want to replicate the results.</li>
<li>
<code>save_path</code>: A directory to which any (data) files will be written.</li>
</ul>
<p>Technical details on the implementation of the analysis can be found in the package documentation.</p>
</div>
<div class="section level2">
<h2 id="results-summary-and-performance-measures">Results: Summary and performance measures<a class="anchor" aria-label="anchor" href="#results-summary-and-performance-measures"></a>
</h2>
<p>Using the <code><a href="../reference/powRICLPM.html">powRICLPM()</a></code> function creates a “powRICLPM” object: A list with results, upon which we can call the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and <code><a href="../reference/coef_powRICLPM.html">coef_powRICLPM()</a></code> functions to summarize and extract the output of our analysis (performance measures), respectively. <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> displays a textual summary in the console, including characteristics of the powRICLPM analysis and the minimally recommended sample size (if any sample size reaches the targeted power level). It also suggests next steps depending on the number of conditions that meet the desired power level for the parameter of interest.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span> <span class="co"># `output` is both a "powRICLPM" and "list" object</span>

<span class="co"># The `summary()` function "detects" that `output` is an  "powRICLPM" object. </span>
<span class="co"># Therefore, it prints a summary specifically tailored for "powRICLPM" objects.</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span>

<span class="co"># Get detailed parameter-specific information</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">output</span>, parameter <span class="op">=</span> <span class="st">"wB2~wA1"</span><span class="op">)</span></code></pre></div>
<p>Detailed results, including performance measures and the number of estimation issues, for a specific parameter can be obtained with <code>coef_powRICLPM</code> and providing a parameter name in the <code>parameter</code> argument. This returns a data frame with rows for the different experimental conditions, and with columns including</p>
<ul>
<li>
<em>errors</em>: the number replications that ended with a fatal error,</li>
<li>
<em>not_converged</em>: the number of replications that did not converge to a solution,</li>
<li>
<em>inadmissible</em>: then number of replications that resulted in inadmissible results for some parameters (e.g., negative variances),</li>
<li>
<em>avg</em>: the average parameter estimate over all replications,</li>
<li>
<em>stdDev</em>: the standard deviation of parameter estimates across replications,</li>
<li>
<em>SEAvg</em>: the average standard error across replications,</li>
<li>
<em>mse</em>: the mean square error,</li>
<li>
<em>acc</em>: the average width of the confidence interval,</li>
<li>
<em>cover</em>: the coverage rate of the confidence interval for the defined significance criterion (by default <span class="math inline">\(\alpha = .05\)</span>), and</li>
<li>
<em>pwr</em>: the proportion of times the <em>p</em>-value was lower than the significance criterion.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jeroen Mulder.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
